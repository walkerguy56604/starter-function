name: Supabase Test

on:
  push:
    branches:
      - main  # or your default branch

jobs:
  test-supabase:
    runs-on: ubuntu-latest

    env:
      SUPABASE_URL: "https://bysigkrrzhdsgxgtiflk.supabase.co"
      SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Test Supabase API
        run: |
          echo "Supabase URL is $SUPABASE_URL"
          echo "Trying to fetch tables from Supabase..."

          curl -H "apikey: $SUPABASE_ANON_KEY" \
               -H "Authorization: Bearer $SUPABASE_ANON_KEY" \
               "$SUPABASE_URL/rest/v1/information_schema.tables?select=table_name"
